.. _compass-verify-signatures-gpg:

==========================================
Verify Packages with GPG (Linux and macOS)
==========================================

.. contents:: On this page
   :local:
   :backlinks: none
   :depth: 1
   :class: singlecol

.. facet::
   :name: genre
   :values: tutorial

.. include:: /includes/verify-signatures-intro.rst

This page describes how to use GPG to verify Linux and macOS packages.

Before you Begin
----------------

.. include:: /includes/verify-signatures-before-you-begin.rst

Steps
-----

.. procedure::
   :style: normal

   .. step:: Import the |compass| public key

      Run this command:

      .. code-block:: sh

         curl https://pgp.mongodb.com/compass.asc | gpg --import

      .. include:: /includes/verification-gpg-results.rst

   .. step:: Download the |compass| public signature

      To download the |compass| public signature, go to the `Compass
      Releases <https://github.com/mongodb-js/compass/releases>`__ page
      on GitHub and download the corresponding ``.sig`` file for your
      version and variant.

      For example, if you are running
      ``mongodb-compass-{+current-version+}-darwin-x64, download
      ``mongodb-compass-{+current-version+}-darwin-x64.zip.sig``

      .. note:: 
         
         Make sure that you select the correct version in the GitHub
         releases page when you download the signature.

   .. step:: Verify the package

      Run this command:

      .. code-block:: sh

         gpg --verify <path_to_signature_file> <path_to_compass_archive>

      If the package is properly signed by MongoDB, the command returns
      this response:
      
      .. code-block:: sh
         :copyable: false

         gpg: Signature made Mon Jan 22 10:22:53 2024 CET
         gpg:                using RSA key AB1B92FFBE0D3740425DAD16A8130EC3F9F5F923
         gpg: Good signature from "Mongosh Release Signing Key <packaging@mongodb.com>" [unknown]
         
      If the package is properly signed but you do not trust the signing
      key in your local ``trustdb``, ``gpg`` returns this message:

      .. code-block:: sh
         :copyable: false

         gpg: WARNING: This key is not certified with a trusted signature!
         gpg:          There is no indication that the signature belongs to the owner.
         
      If the package is not signed properly, the command returns an
      error message:

      .. code-block:: sh
         :copyable: false

         gpg: Signature made Mon Jan 22 10:22:53 2024 CET
         gpg:                using RSA key AB1B92FFBE0D3740425DAD16A8130EC3F9F5F923
         gpg: BAD signature from "Mongosh Release Signing Key <packaging@mongodb.com>" [unknown]
